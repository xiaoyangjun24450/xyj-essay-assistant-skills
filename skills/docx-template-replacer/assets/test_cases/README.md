# 测试用例说明

## 测试场景
基于毕业设计任务书模板，生成一份新题目（基于ESP32的无感FOC驱动设计）的任务书，同时**完全保留原模板的格式**。

## 文件说明

| 文件 | 说明 |
|------|------|
| `template.docx` | 原始模板文件（题目：基于三维激光雷达的智能移动充电桩的自动驾驶方法研究） |
| `test_replacements.py` | 测试脚本，定义了所有替换规则 |
| `test_output.docx` | 生成的输出文件（题目：基于ESP32的无感FOC驱动设计） |

## 替换内容对照

### 1. 题目
- **原文**：基于三维激光雷达的智能移动充电桩的自动驾驶方法研究
- **新文**：基于ESP32的无感FOC驱动设计

### 2. 目的和意义
- **原文**：介绍智能移动充电桩、三维激光雷达、自动驾驶底盘
- **新文**：介绍无感FOC控制技术、ESP32平台、电机控制应用

### 3. 学生应完成的任务

| 序号 | 原文 | 新文 |
|------|------|------|
| (1) | 调研自动驾驶底盘技术，掌握ROS2、Python/C++ | 调研无感FOC控制技术，掌握ESP32开发环境 |
| (2) | 探究三维激光雷达算法、地面分割、路径规划 | 研究FOC算法、Clarke/Park变换、SVPWM |
| (3) | 设计电机驱动系统、底盘运动控制、激光雷达驱动 | 设计驱动硬件电路、电源模块、电流采样 |
| (4) | 研究fast-lio2、Cartographer地图构建 | 实现无感FOC算法、电流环/速度环设计 |
| (5) | 编写点云转换、路径规划功能包，开发云服务器API和UI | 开发上位机监控软件、实时显示电机状态 |

### 4. 时间分配

| 部分 | 原文 | 新文 |
|------|------|------|
| 第二部分 | 完成自动驾驶底盘选型与控制，激光雷达驱动程序开发 | 完成ESP32开发环境搭建，电机驱动硬件电路设计 |
| 第三部分 | 里程计与地图定位算法实现，地图构建功能开发 | 实现SVPWM调制算法，电流环和速度环控制 |
| 第四部分 | 路径规划算法开发与实车自动驾驶测试 | 实现无感位置观测算法，电机参数辨识与调试 |
| 第五部分 | 完成云服务器通信与网页调度界面开发，毕业论文撰写 | 完成上位机软件开发，毕业论文撰写 |

## 验证要点

打开 `test_output.docx`，检查以下内容是否保留原格式：

- [ ] 页眉："西南交通大学本科毕业设计（论文）" 及底部横线
- [ ] 页边距：与模板一致
- [ ] 行距：正文520 twips，时间分配部分500 twips
- [ ] 字体：标题黑体三号，正文宋体小四
- [ ] 下划线：班级、姓名、学号、题目、所有正文段落
- [ ] 段落缩进：时间分配部分左缩进357 twips

## 运行测试

### 生成文档
```bash
cd .codebuddy/skills/docx-template-replacer/assets/test_cases
python3 test_replacements.py
```

### 验证格式
```bash
# 详细格式验证
python3 ../../scripts/verify_format.py template.docx test_output.docx

# 文件对比
python3 ../../scripts/compare_docx.py template.docx test_output.docx
```

## 预期结果

### 生成脚本输出：
```
============================================================
DOCX Template Replacer - Test Case
============================================================
...
Step 4/4: Verifying output structure...
  ✓ All checks passed!
============================================================
Test completed successfully!
============================================================
```

### 格式验证输出：
```
=== 格式元素检查 ===
✓ 页边距 (w:pgMar)
   模板: <w:pgMar w:top="1474" w:right="1531"...>
   输出: <w:pgMar w:top="1474" w:right="1531"...>
✓ 页面大小 (w:pgSz)
✓ 页眉引用
✓ 页脚引用
✓ 行距520段落数
   模板: 19
   输出: 19
...
========================================
✓ 验证通过 - 格式完全匹配！
```
